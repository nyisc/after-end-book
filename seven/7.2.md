## 7.2 用户管理
### 7.2.1 用户概览
本节部分转载于[https://www.jianshu.com/p/b6a7db60f8c9](https://www.jianshu.com/p/b6a7db60f8c9)
首先介绍以下AAA。
**1、AAA介绍**
AAA指的是Authentication、Authorization、Accounting，即认证、授权和审计。

- 认证：验证用户是否可以获得权限，是3A的第一步，即验证身份；
- 授权：授权用户可以使用那些服务或资源，即身份验证成功后，赋予这个身份相应的权限；
- 审计：记录用户的操作情况，在Linux中，日志就是审计的一种手段。

Linux的用户和组管理可以说是基于AAA进行的，首先用户登录输入用户名密码，就是认证的过程；其次，在用户登录成功后，所拥有的权限各不相同，这就是授权；最后，用户的操作历史会记录在日志中，这是审计。
接下来介绍Linux中用户和组的类别，以及Linux是如何标识每个用户和组的：
**2、Linux用户类别**
Linux中，用户分为两大类、三小类：
分别为**管理员**（一般为root）和**普通用户**  。
普通用户中，又划分为两类，分别为_系统用户_和_登录用户_。

- 管理员

即超级用户，可以操作系统中任意文件和命令，拥有最高的管理权限。

Tips：一般情况下尽量不要使用root登录系统，避免误操作。
- 普通用户
又分为登录用户和系统用户：
  - 登录用户

一般为管理员手动添加的用户，默认仅拥有操作自身家目录中文件及目录的权限，以及进入与浏览相关目录文件的权限（如/etc、/var/log等），但没有创建、修改、删除等权限。
  - 系统用户

一般为系统安装后默认存在的，且默认情况下不能登录系统，它们的存在主要是为了满足系统进程对文件属主的需求。

Tips：在部署某些服务是，也可以手动添加某些系统用户。

**3、Linux用户标识（UID）**
Linux系统使用UID（User ID）来标识不同用户。
UID是16bits的二进制数字，所以换算成十进制，UID的范围是0~65535，Linux根据用户类别，对UID划分做了规定：

- 管理员

UID为0

Tips：当用户UID为0时，该用户就是管理员，所以不只root才是管理员，可以手动指定，但不建议。
- 普通用户（1~65535）
  - 系统用户

一般发行版为1999）
  - 登录用户

一般发行版为50065535）

Tips：Linux是根据“名称解析库”（/etc/passwd）来进行用户名和UID的解析的，后面会详细介绍Linux中用户和组的相关信息库文件。
### 7.2.2 基本命令
1.查看当前用户：whoami
由于系统管理员通常需要使用多种身份登录系统，例如通常使用普通用户登录系统，然后再以su命令切换到root身份对传统进行管理。这时候就可以使用whoami来查看当前用户的身份。

2.查看当前登陆用户 who

| 选项 | 含义 |
| --- | --- |
| -m | 只显示运行who命令的用户名、登录终端和登录时间 |
| -q或--count | 只显示用户的登录账号和登录用户的数量 |
| -u | 在登录时间后显示该用户最后一次操作到当前的时间间隔 |


3.退出当前账户：exit
如果是切换后的登陆用户，退出则返回上一个登陆账号。

4.添加用户账户：useradd

| 选项 | 含义 |
| --- | --- |
| -m | 自动建立目录 |
| -g | 指定组名称 |
| -d | 指定用户登录系统时的主目录，如果不使用该参数，系统自动在/home目录下建立与用户名同名目录为主目录 |


5.设置用户密码：passwd　用户名

6.删除用户：userdel

| 选项 | 含义 |
| --- | --- |
| -r | 删除用户，同时删除主目录 |


7.切换用户：su
可以通过su命令切换用户，su后面可以加“-”。su和su –命令不同之处在于，su -切换到对应的用户时会将当前的工作目录自动转换到切换后的用户主目录

8.添加、删除组账号：groupadd、groupdel
groupadd 新建组账号
groupdel删除 组账号
cat /etc/group 查看用户组

9.修改用户所在组：usermod
使用方法：usermod -g 目标用户组 当前用户名
10.修改文件权限：chmod
chmod 修改文件权限有两种使用格式：字母法与数字法。
（1）字母法：chmod u/g/o/a +/-/= rwx 文件
u	user 表示该文件的所有者
g	group 表示与该文件的所有者属于同一组( group )者，即用户组
o	other 表示其他以外的人
a	all 表示这三者皆是

+	增加权限
-	撤销权限
=	设定权限

| 字母 | 含义 |
| :--- | :--- |
| r | read 表示可读取，对于一个目录，如果没有r权限，那么就意味着不能通过ls查看这个目录的内容。 |
| w | write 表示可写入，对于一个目录，如果没有w权限，那么就意味着不能在目录下创建新的文件。 |
| x | excute 表示可执行，对于一个目录，如果没有x权限，那么就意味着不能通过cd进入这个目录。 |

2）数字法：“rwx” 这些权限也可以用数字来代替
字母	说明
r	读取权限，数字代号为 "4"
w	写入权限，数字代号为 "2"
x	执行权限，数字代号为 "1"
-	不具任何权限，数字代号为 "0"

11.修改文件所有者：chown
使用方法：chown 用户名 文件名/目录名
12.修改文件所属组：chgrp
使用方法：chgrp 用户组名 文件名/目录名
注意区别 usermod 与chgrp

-  usermod 修改用户所在组的命令
-  chgrp修改文件所属组
### 7.2.3 用户权限
| 字母 | 含义 |
| :--- | :--- |
| r | read 表示可读取，对于一个目录，如果没有r权限，那么就意味着不能通过ls查看这个目录的内容。（数字代号为 "4"） |
| w | write 表示可写入，对于一个目录，如果没有w权限，那么就意味着不能在目录下创建新的文件。（数字代号为 "2"） |
| x | excute 表示可执行，对于一个目录，如果没有x权限，那么就意味着不能通过cd进入这个目录。（数字代号为 "1"） |
